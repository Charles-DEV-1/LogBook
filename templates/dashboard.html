{% extends "base.html" %}
{% block title %}Student Dashboard{% endblock %}
{% block content %}

<!-- Profile Section aligned right -->
<div class="d-flex justify-content-end mt-3 mb-4">
  <div class="profile-pic-wrapper-small">
    <img src="{{ url_for('static', filename='uploads/' ~ (user.profile_pic if user.profile_pic else 'default.png')) }}" 
         alt="Profile Picture" class="profile-pic-small">
  </div>
</div>

<h2 class="mb-4 text-white">Welcome {{ user.username }} ü´°</h2>
<h2 class="mb-4 text-white">üë©‚Äçüéì My Log Entries</h2>
<a href="{{ url_for('create_entry') }}" class="btn btn-custom mb-3">+ New Entry</a>

<div class="row">
  {% for log in logs %}
    <div class="col-md-4 mb-4">
      <div class="card p-3 text-white shadow-lg glass-card">
        <h5>{{ log.task_description[:40] }}...</h5>
        <p class="small"><strong>Date:</strong> {{ log.created_at.strftime("%Y-%m-%d") }}</p>
        <p class="small"><strong>Hours:</strong> {{ log.hours or "‚Äî" }}</p>
        <p class="small"><strong>Challenges:</strong> {{ log.challenges[:60] or "‚Äî" }}...</p>
        <p class="small"><strong>Lessons:</strong> {{ log.lessons[:60] or "‚Äî" }}...</p>
        <p class="small"><strong>Activities:</strong> {{ log.activities[:60] or "‚Äî" }}...</p>

        {% if log.attachments %}
          <p><b>Attachments:</b></p>
          <ul>
            {% for att in log.attachments %}
              <li><a href="{{ url_for('upload', filename=att.filename) }}" target="_blank">{{ att.filename }}</a></li>
            {% endfor %}
          </ul>
        {% endif %}

        <!-- Buttons INSIDE loop -->
        <div class="d-flex justify-content-between mt-2">
          <a href="{{ url_for('edit_entry', id=log.id) }}" class="btn btn-outline-light btn-sm">Edit</a>
          <a href="{{ url_for('delete_entry', id=log.id) }}" class="btn btn-outline-danger btn-sm" onclick="return confirm('Are you sure you want to delete this event?')">Delete</a>
        </div>
      </div>
    </div>
  {% else %}
    <p>No log entries yet.</p>
  {% endfor %}
</div>

<style>
  /* Small Profile Pic Styling (top-right) */
  .profile-pic-wrapper-small {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    padding: 2px;
    background: linear-gradient(135deg, #007bff, #00c6ff);
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  }

  .profile-pic-small {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #fff;
  }

  /* Card Styling */
  .glass-card {
    background: rgba(0, 123, 255, 0.1);
    border-radius: 15px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.15);
    transition: transform 0.2s ease-in-out;
  }

  .glass-card:hover {
    transform: translateY(-5px);
  }
</style>

{% endblock %}
